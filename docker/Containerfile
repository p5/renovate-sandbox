FROM fedora:40

# renovate datasource=git-refs packageName=https://github.com/ggerganov/whisper.cpp depName=whisper.cpp
ARG WHISPER_CPP_COMMIT=22fcd5fd110ba1ff592b4e23013d870831756259

RUN git clone https://github.com/ggerganov/whisper.cpp.git && \
    cd whisper.cpp && \
    git reset --hard ${WHISPER_CPP_COMMIT} && \
    make -j $(nproc) && \
    mv main /usr/bin/whisper-main && \
    mv server /usr/bin/whisper-server && \
    cd / && \
    rm -rf whisper.cpp
